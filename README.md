NUMB - (N)ucleotide Excision Repair and (U)V Signature (M)elanoma (B)iomarker 

A project exploring the relationship between UV signature mutation and the pathway which repairs it, nucleotide excision repair (NER), in relation to skin cutaneous melanoma patients.

R scripts in this project:

processData - Unifies data downloaded from cBioPortal.org for easy use throughout the rest of the project, deconvolutes mutational signatures, appends a UV signature column to patient clinical annotations, and identifes mutations and copy number variations present in each patient's NER pathway genes.  Allows for optional filtering of samples to preselected list, otherwise will run on all samples present in a cohort.  Function requires data to be in the format generated by cBioPortal.org, would require modification to work with other data formatting.  Outputs:
- clinical.csv; Merged patient and sample data, with appended UV signature (COSMIC signature 7) and NER signature
- tnm.csv; Trinucleotide context SNV class table for each sample
- mutationalSignatures.csv; Deconvoluted signatures, reference signatures used are COSMIC SBS V3 signatures
- NER_mutSig.csv; Table showing all mutations present within the NER pathway for each sample
- NER_cnvSig.csv; Table showing all CNV deletions present within the NER pathway for each sample
- NER_mutCNVsig.csv; Table showing combined mutations and CNV deletions present within the NER pathway for each sample

analyzeClinical - Analyzes and outputs a number of plots showing different characteristics of the samples present in the cohort, both holistically and as they relate to the level of UV signature present.  All required inputs are generated by processData.  Some user input is required to finish plot generation, and there are some TCGA SKCM specific plots.  Outputs:
- Signature plots; signature breakdown per sample and average UV signature as % of total signature by level plots
- TNM plots; SNV class breakdown per sample and C>T transversions at dipyrimidine occurrence (in context of all mutation classes) by UV level plots
- SNV plots; average SNV by UV level, SNV per sample, and TMB per sample plots
- Feature plots; prevalence of UV-signature high for each age group, stage plots (SKCM specific), and user inputted feature status per sample plots
- Control plots; mutation status by UV level for each melanoma control gene plots
- Survival plots; survival curve for cohort, stratifying by UV signature level

analyzeNER - Analyzes the cohort for specific alterations in the NER pathway, as well as a select number of earlier plots in the context of both NER alteration and UV signature.  All required inputs are generated by processData.  Outputs: 
- NER_Oncoplot.pdf; A plot showing all alterations in the NER pathway, generated by the oncoplot function from R package "maftools"
- NER_pcts.pdf; % of samples with NER pathway alteration by UV level plot
- NER_gene_pcts.pdf; % of samples with alteration for each specific gene in NER signature by UV level plot
- Survival_NER.pdf; multi-condition strata for each combination of UV level and NER proficiency status

permutationTest - Performs a permutation test on the cohort to ensure that observed trends are not random due to the overwhelming mutation burden seen in skin cutaenous melanomas.  The input to this test is a matrix of all samples as rows, and gene mutation or CNV deletion status (in over 5% of samples to make computation time realistic) in columns. A null matrix is generated via the curve-ball algorithm, which is then compared with the original matrix.  If the randomized matrix has a higher High-Low ratio for a gene, p value for that gene increases.  The user selects the number of permutations to be executed.  Outputs:
- Permutations_Raw.csv; The raw p-values for all genes after X number of permutations
- Permutation_Results_qValues.csv; The same as above, with genes belonging to pathways highlighted and q-values added
- Permutation_Test_Plot.pdf; -log transformed q values for each gene with previously described highlights plot
